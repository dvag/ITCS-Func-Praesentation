import{r as t,h as e,H as i,g as s}from"./p-c66bef8d.js";import{S as n}from"./p-968cb048.js";import{E as a}from"./p-70f48e14.js";import{D as o}from"./p-31a88832.js";import{a as r}from"./p-dc250dcd.js";import{o as h}from"./p-90458c1b.js";import{f as l}from"./p-aa0a06c6.js";import{e as d}from"./p-1cba59f7.js";import{D as c}from"./p-dde9fdba.js";import"./p-fabbcf47.js";import"./p-15b13381.js";const u=class{constructor(e){t(this,e),this.errors={from:c.NO_ERROR,to:c.NO_ERROR},this.onFocus=()=>this.currentlyFocused=!0,this.onBlur=()=>this.handleBlur(),this.onError=t=>this.handleError(t),this.onDateValueChange=t=>this.handleDateValueChange(t),this.currentlyFocused=!1,this.internalErrorMessage="",this.mode="day-month-year",this.value=null}onValueChange(){const t=d(this.value);this.selectRange(t)}connectedCallback(){this.slotObserver=new n(this.self,"ds-date-input",(t=>{r(2===t.length,(()=>"You have to define exactly two ds-date-inputs within this component"));const e={from:null,to:null};t.forEach((t=>{t.removeEventListener("focus",this.onFocus),t.addEventListener("focus",this.onFocus),t.removeEventListener("blur",this.onBlur),t.addEventListener("blur",this.onBlur),t.removeEventListener("errorFound",this.onError),t.addEventListener("errorFound",this.onError),t.removeEventListener("valueChange",this.onDateValueChange),t.addEventListener("valueChange",this.onDateValueChange),t.min=this.min,t.max=this.max,t.mode=this.mode,t.calendarenabled=!1,e[t.slot]=o.stringToDate(t.value)})),this.selectRange(null!=this.value?d(this.value):e)}))}disconnectedCallback(){this.slotObserver.disconnect()}componentDidLoad(){this.updateCalendarValue()}onSegmentBlurred(){this.updateCalendarValue()}async focusControl(){var t;null===(t=this.self.querySelector("ds-date-input"))||void 0===t||t.focusControl()}updateCalendarValue(){null!=this.calendar&&(this.calendar.value=this.value)}setCalendar(t){this.calendar!==t&&(this.calendar=t,this.updateCalendarValue())}handleBlur(){h((()=>{document.activeElement!==this.self&&!l(document.activeElement,(t=>t===this.self))&&(this.currentlyFocused=!1)}))}handleError(t){this.errors[t.target.slot]=t.detail.type,this.internalErrorMessage={[c.INVALID_DATE]:()=>"Invalides Datum gefunden!",[c.UNDER_MIN]:()=>`Die eingegeben Daten müssen nach dem ${o.getFormattedDisplayDate(this.min)} liegen.`,[c.OVER_MAX]:()=>`Die eingegeben Daten müssen vor dem ${o.getFormattedDisplayDate(this.max)} liegen.`,[c.NO_ERROR]:()=>""}[this.errors.from!==c.NO_ERROR?this.errors.from:this.errors.to]()}handleDateValueChange(t){const e=t.target;if(!e.slot)return;const i=d(this.value);i[e.slot]=t.detail?new Date(t.detail):null,this.selectRange(i)}getDateInputs(){return Array.from(this.self.querySelectorAll("ds-date-input"))}selectRange(t,e="other"){var i,s;this.value=`${null!==(i=o.dateToString(t.from))&&void 0!==i?i:""},${null!==(s=o.dateToString(t.to))&&void 0!==s?s:""}`;const n=this.getDateInputs();n[0]&&(n[0].value=o.dateToString(t.from),"calendar-widget"===e&&n[0].internalForceEmitChangeEvent()),n[1]&&(n[1].value=o.dateToString(t.to),"calendar-widget"===e&&n[1].internalForceEmitChangeEvent())}renderCalendar(){var t,i;if(!this.currentlyFocused)return;const s=this.getDateInputs();return e("ds-calendar",{slot:"overlay",id:a.createId(this.self,"calendar"),ref:t=>this.setCalendar(t),tabindex:-1,errormessage:this.internalErrorMessage||(null===(t=s[0])||void 0===t?void 0:t.errormessage)||(null===(i=s[1])||void 0===i?void 0:i.errormessage),rangeenabled:!0,onBlur:()=>{this.onBlur()},min:this.min,max:this.max,onRangeSelected:t=>{this.selectRange(t.detail,"calendar-widget")},mode:this.mode})}render(){return e(i,null,e("dx-overlay",{position:"bottom",offsety:8,disabled:!this.currentlyFocused},e("div",{class:"date-container"},e("div",{class:"date-input-container"},e("slot",{name:"from"})),e("div",{class:"date-input-container"},e("slot",{name:"to"}))),this.renderCalendar()))}get self(){return s(this)}static get watchers(){return{value:["onValueChange"]}}};u.style=':host{display:block;overflow:hidden;--ds-date-input-calendar-display:none}:host:host([hidden]){display:none !important}:host .date-container{display:flex;align-items:baseline;flex-wrap:wrap;column-gap:24px;row-gap:16px}:host .date-container .date-input-container{flex:1;flex-basis:139px}:host .date-container .date-input-container:first-child{position:relative}:host .date-container .date-input-container ::slotted(*:first-child):after{font-family:"Helvetica Neue", "Helvetica Neue LT W01";content:"-";color:#666666;display:flex;top:0;right:-24px;width:24px;height:100%;align-items:center;justify-content:center;position:absolute}:host .date-container .date-input-container ::slotted(*:first-child[label]):after{top:12px}';export{u as ds_date_range}
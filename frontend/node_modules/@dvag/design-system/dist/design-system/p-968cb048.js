import{n as t}from"./p-fabbcf47.js";class s{constructor(t,s,i,n=!1){this.componentElement=t,this.tagNameToFilter=s,this.callback=i,this.pierceShadowDom=n,this.lastEmittedNodesOuterHtml=null;const h=this.findAllNodes();this.checkAllHydrated(h)&&i(this.findAllNodes()),this.mutationObserver=new MutationObserver((()=>this.onMutation())),this.connect()}connect(){this.mutationObserver.observe(this.componentElement,{childList:!0,subtree:!0,attributes:!0})}disconnect(){this.mutationObserver.disconnect()}checkAllHydrated(t){return t.every((t=>!i(null==t?void 0:t.tagName)||t.classList.contains("hydrated")))}findAllNodes(){const t=this.tagNameToFilter.toLowerCase(),s=i(t)?`${this.tagNameToFilter}`:t;return this.pierceShadowDom?n(this.componentElement,t):Array.from(this.componentElement.querySelectorAll(s))}onMutation(){const t=this.findAllNodes();if(this.checkAllHydrated(t)){const s=t.map((t=>t.outerHTML)).reduceRight(((t,s)=>t+s),"");this.lastEmittedNodesOuterHtml!==s&&(this.lastEmittedNodesOuterHtml=s,this.callback(t))}else this.pierceShadowDom&&setTimeout((()=>this.onMutation()),30)}}function i(t){const s=null==t?void 0:t.toLowerCase();return(null==s?void 0:s.startsWith("ds-"))||(null==s?void 0:s.startsWith("dx-"))}const n=(t,s)=>{const i=h(t),n=s.toLowerCase();return i.filter((t=>"*"===s||t.tagName.toLowerCase()===n))},h=t=>{const s=[];return t.querySelectorAll("*").forEach((t=>s.push(t))),t.querySelectorAll("slot").forEach((t=>{t.assignedElements().forEach((t=>s.push(t)))})),s.forEach((t=>{h(t).forEach((t=>s.push(t)))})),s};function o(i,n,h,o=!1){return new s(i,t(n),h,o)}function r(...t){return t.map((t=>`:scope > ${t}`)).join(", ")}export{s as S,o as c,r as d}
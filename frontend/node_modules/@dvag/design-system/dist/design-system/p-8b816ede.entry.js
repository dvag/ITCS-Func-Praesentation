import{r as t,c as i,h as s,f as e,H as o,g as n}from"./p-c66bef8d.js";import{E as l}from"./p-70f48e14.js";import{c as h}from"./p-968cb048.js";import{a as r,c as a}from"./p-dc250dcd.js";import{i as c}from"./p-e0194d22.js";import"./p-15b13381.js";import"./p-fabbcf47.js";const d=class{constructor(s){t(this,s),this.selection=i(this,"selection",7),this.listOpenChange=i(this,"listOpenChange",7),this.align="left",this.selectionmode="single",this.maxlabels=1,this.listOpen=!1}onListOpenChanged(){this.listOpenChange.emit({isOpen:this.listOpen})}connectedCallback(){this.menuItemsObserver=h(this.self,"dx-overflow-menu-item",(async t=>{await this.collectMenuItems(t),this.updateInternalLabel()}))}disconnectedCallback(){this.menuItemsObserver.disconnect()}componentWillRender(){r(null==this.maxselections||c(this.maxselections),(()=>"The `maxselections` property has to be a natural number greater than zero ([1,2,3,...]) or undefined."),this.self),r(null==this.maxlabels||c(this.maxlabels),(()=>"The `maxlabels` property has to be a natural number greater than zero ([1,2,3,...]) or undefined."),this.self),a("dx-overflow-menu","selectionmode",this.selectionmode,["single","multi"],this.self)}onItemSelectionChange(t){var i;t.stopPropagation();const s=null===(i=t.detail)||void 0===i?void 0:i.selectedItems;this.emitSelection(s),"single"===this.selectionmode&&(this.listOpen=!1),this.updateMenuItems(s),this.updateInternalLabel()}updateMenuItems(t){this.menuItems.forEach((i=>{i.setSelected(null!=t.find((t=>t===i.value)))}))}updateInternalLabel(){"single"===this.selectionmode?this.internalLabel="":"multi"===this.selectionmode&&(this.internalLabel=this.computeInternalLabel())}computeInternalLabel(){const t=this.menuItems.filter((t=>t.selected)).map((t=>t.value)),i=t.map((t=>this.menuItems.find((i=>i.value===t)))).map((t=>t.label)).slice(0,this.maxlabels),s=t.length-i.length;return 0===s?i.join(", "):i.join(", ")+` (+${s})`}emitSelection(t){this.selection.emit({value:"single"===this.selectionmode?t[0]:t})}async collectMenuItems(t){this.menuItems=await Promise.all(t.map((t=>t.toOverflowMenuItem())))}onInputKeyDown(t){const i=this.self.shadowRoot.querySelector("dx-list-flyout");t.target!==i&&((null==i?void 0:i.open)&&"Tab"!==t.code?(t.preventDefault(),null==i||i.dispatchEvent(new t.constructor(t.type,t))):"ArrowDown"===t.code&&(this.listOpen=!0))}renderButtonIconSlot(){var t,i;return(null===(t=this.internalLabel)||void 0===t?void 0:t.length)>0||(null===(i=this.label)||void 0===i?void 0:i.length)>0?s("dx-chevron",{size:24,slot:"icon",directiontop:this.listOpen}):s("dx-element-swapper",{active:this.listOpen?"second":"first",slot:"icon"},s("dx-icon",{icon:"ueberlauf-menue",slot:"first",size:24}),s("dx-icon",{icon:"schliessen",slot:"second",size:24}))}renderTextButton(){return s("dx-button",{id:l.createId(this.self,"menu-button"),class:{"simulate-active":this.listOpen},onKeyDown:t=>this.onInputKeyDown(t),type:"text",slot:"base",label:this.internalLabel||this.label,onClick:()=>this.listOpen=!this.listOpen,iconposition:"right"},this.renderButtonIconSlot())}render(){var t,i;return s(o,{onBlur:()=>{this.listOpen=!1},class:{"align-right":"right"===this.align,"mock-list-item-width":null===(t=this.menuItems)||void 0===t?void 0:t.some((t=>{var i;return(null===(i=t.icon)||void 0===i?void 0:i.length)>0}))}},this.renderTextButton(),s("dx-list-flyout",{class:"list-flyout",open:this.listOpen,direction:"left"===this.align?"right":"left",itemsvisible:5.5,size:"m",selectionmode:this.selectionmode,selectonhighlight:!1,clearselectiononclose:"single"===this.selectionmode,maxselections:this.maxselections,ref:t=>e(t)},null===(i=this.menuItems)||void 0===i?void 0:i.map(((t,i)=>{var e;return s("dx-list-item",{id:null!==(e=l.createIdFromString(t.id,"list-item"))&&void 0!==e?e:l.createId(this.self,`list-item-${i}`),label:t.label,value:t.value,icon:t.icon,selected:t.selected,type:"single"===this.selectionmode?"clickable":"checkbox"})}))))}get self(){return n(this)}static get watchers(){return{listOpen:["onListOpenChanged"]}}};d.style=":host{display:block;--dx-flyout-simple-grow-box-width:fit-content;--dx-flyout-simple-grow-box-min-width:192px;--dx-overlay-popup-max-width:max-content;--dx-overlay-offset:40px;text-align:left}:host:host([hidden]){display:none !important}:host:host(.align-right){text-align:right;display:flex;flex-direction:column;align-items:flex-end}:host:host(.mock-list-item-width){--dx-list-mock-icon-container-width:40px}:host .list-flyout{min-width:192px}";export{d as dx_overflow_menu}
import{r as t,h as i,H as o,g as n}from"./p-c66bef8d.js";import{c as e}from"./p-968cb048.js";import{C as s}from"./p-e5e316fc.js";import{d as l}from"./p-ac26d544.js";import{E as r}from"./p-70f48e14.js";import"./p-fabbcf47.js";import"./p-dc250dcd.js";import"./p-15b13381.js";const d=class{constructor(i){t(this,i),this.colorPalette=new s,this.donutvisible=!0,this.secondcontributionlabel=null}connectedCallback(){this.slotObserver=e(this.self,"ds-fm-ergebnisuebersicht-table",(t=>{requestAnimationFrame((async()=>{var i;this.tables=await Promise.all(t.map((t=>t.toErgebnisUebersichtTable()))),this.allItems=null===(i=this.tables)||void 0===i?void 0:i.map((t=>t.items)).flat()}))}))}disconnectedCallback(){var t;null===(t=this.slotObserver)||void 0===t||t.disconnect()}showSegmentInfo(t){this.selectedItem=t}renderChartSamples(){var t;return null===(t=this.allItems)||void 0===t?void 0:t.map(((t,o)=>i("ds-chart-sample",{value:t.firstcolumnvalue,label:t.label,color:this.colorPalette.getWheelColorCode(o)})))}renderDonutChartContent(t){var o,n,e;const s=null!=this.selectedItem,r=s?`${l(null===(o=this.allItems[this.selectedItem])||void 0===o?void 0:o.firstcolumnvalue,2)} €`:this.donutcenterlabel,d=null===(n=Math.floor(t))||void 0===n?void 0:n.toString(),a=(null==d?void 0:d.length)>4?"u3":"u2";return i("div",{slot:"content",class:"donut-content"},i("ds-text",{class:"primary-label",screensize:"small"},s?(c=null===(e=this.allItems)||void 0===e?void 0:e[this.selectedItem].label).length<=20?c:`${c.substring(0,17)}...`:i("span",null,this.donutlabel)),i("ds-text",{screensize:"small",type:a,color:s?this.colorPalette.getWheelColor(this.selectedItem):void 0,class:"sum"},r),i("ds-text",{screensize:"small",color:"hellgrau-3"},this.donutsublabel));var c}renderValueCell(t,o,n,e,s){var r;return i("div",{class:{cell:!0,first:n,last:e,highlight:s}},i("ds-info",{id:(null!==(r=this.self.id)&&void 0!==r?r:"")+"-columninfo-"+(a+=1),hidebutton:!((null==o?void 0:o.length)>0)},i("ds-text",{slot:"content",type:"ft"},o),i("ds-text",{class:"value"},isNaN(t)?"unbekannt":l(t,2)+" €")))}renderHeaderRow(t){var o,n,e;return i("div",{class:"row"},i("div",{class:"cell label"},i("ds-text",{type:"ftf"},t.label)),i("div",{class:"cell"},i("ds-info",{id:r.createId(this.self,"first-column-info"),hidebutton:!((null===(o=this.firstcolumninfo)||void 0===o?void 0:o.length)>0)},i("ds-text",{slot:"content",type:"ft"},this.firstcolumninfo),i("ds-text",{type:"it"},this.firstcolumn))),(null===(n=this.secondcolumn)||void 0===n?void 0:n.length)>0?i("div",{class:"cell"},i("ds-info",{id:r.createId(this.self,"second-column-info"),hidebutton:!((null===(e=this.secondcolumninfo)||void 0===e?void 0:e.length)>0)},i("ds-text",{slot:"content",type:"ft"},this.secondcolumninfo),i("ds-text",{type:"it"},this.secondcolumn))):null)}renderTable(t,o=0){var n;return i("div",{class:"table"},[this.renderHeaderRow(t),null===(n=t.items)||void 0===n?void 0:n.map(((n,e)=>{var s,l;const r=0===e,d=e===t.items.length-1;return i("div",{class:"row"},i("div",{class:"cell label"},i("ds-column",{class:"color-indicator",style:{"border-color":this.colorPalette.getWheelColorCode(e+o)}},i("ds-text",null,n.label),(null===(s=n.sublabel)||void 0===s?void 0:s.length)>0?i("ds-text",{type:"itk"},n.sublabel):null)),[this.renderValueCell(n.firstcolumnvalue,n.firstcolumninfo,r,d,!0),(null===(l=this.secondcolumn)||void 0===l?void 0:l.length)>0?this.renderValueCell(n.secondcolumnvalue,n.secondcolumninfo,r,d,!1):null])}))])}render(){var t,n,e,s;const l=null!==(e=null===(n=null===(t=this.allItems)||void 0===t?void 0:t.map((t=>t.firstcolumnvalue)))||void 0===n?void 0:n.reduce(((t,i)=>t+i),0))&&void 0!==e?e:0,r=!(!this.firstcontributionlabel||!this.secondcontributionlabel);return i(o,null,i("div",{class:{"donut-info-container":!0,visible:this.donutvisible}},i("ds-donut-chart",{radius:100,segmentwidth:10,scale:2,offset:5,onSegmentSelect:t=>this.showSegmentInfo(t.detail)},this.renderDonutChartContent(l),this.renderChartSamples()),i("div",{style:{display:"flex",width:"100%"}},i("div",{class:{"contribution-container":!0,right:r}},i("ds-column",{class:"info"},i("ds-text",null,this.firstcontributionlabel),i("ds-text",{type:"ftf"},this.firstcontributionsublabel))),r?[i("div",{class:"info-center"}," "),i("div",{class:"contribution-container left"},i("ds-column",{class:"info"},i("ds-text",null,this.secondcontributionlabel),i("ds-text",{type:"ftf"},this.secondcontributionsublabel)))]:null),i("ds-hr",{style:{"margin-top":"32px","margin-bottom":"24px"}})),null===(s=this.tables)||void 0===s?void 0:s.map(((t,i)=>{const o=this.tables.slice(0,i).map((t=>t.items.length)).reduce(((t,i)=>t+i),0);return this.renderTable(t,o)})))}get self(){return n(this)}};let a=0;d.style=":host{display:block}:host:host([hidden]){display:none !important}:host .donut-info-container{display:none;flex-direction:column;align-items:center;position:relative}:host .donut-info-container.visible{display:flex}:host .donut-info-container .donut-content{display:flex;flex-direction:column;align-items:center;text-align:center;justify-content:center}:host .donut-info-container .donut-content .primary-label{width:130px;height:48px}:host .donut-info-container .donut-content .sum{margin-top:16px;margin-bottom:8px;white-space:nowrap;height:36px}:host .donut-info-container ds-donut-chart{margin-bottom:24px}:host .donut-info-container .contribution-container{display:flex;flex:1;justify-content:center}:host .donut-info-container .contribution-container.left{justify-content:flex-start;text-align:left}:host .donut-info-container .contribution-container.left ds-column :nth-child(n){position:relative;right:50%}:host .donut-info-container .contribution-container.right{justify-content:flex-end;text-align:right}:host .donut-info-container .contribution-container.right ds-column :nth-child(n){position:relative;left:50%}:host .donut-info-container .info{text-align:center}:host .donut-info-container .info ds-text{width:100%}:host .donut-info-container .info-center{flex-basis:224px;flex-grow:0}:host .table{display:flex;flex-direction:column}:host .table:not(:last-child){margin-bottom:32px}:host .table .row{display:flex}:host .table .row .cell{display:flex;text-align:right;justify-content:flex-end;align-items:center;flex:1.33;flex-basis:120px;flex-shrink:0;min-width:100px;padding:12px 8px}:host .table .row .cell.first{border-top-left-radius:6px;border-top-right-radius:6px}:host .table .row .cell.last{border-bottom-left-radius:6px;border-bottom-right-radius:6px}:host .table .row .cell:not(:last-child){margin-right:24px}:host .table .row .cell.label{text-align:left;justify-content:flex-start;flex:5;flex-basis:480px}:host .table .row .cell.highlight{background-color:#f5f5f5}:host .table .row .cell .value{white-space:nowrap}:host .table .row .cell ds-column{border-left:4px solid;padding-left:8px;border-color:black}";export{d as ds_fm_ergebnisuebersicht}
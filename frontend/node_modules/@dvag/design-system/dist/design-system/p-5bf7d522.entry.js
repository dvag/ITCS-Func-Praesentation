import{r as t,c as i,h as s,H as e,g as n}from"./p-c66bef8d.js";import{D as h,f as r}from"./p-31a88832.js";import{E as o}from"./p-70f48e14.js";import{h as a,E as l}from"./p-747d527e.js";import{a as d}from"./p-aa0a06c6.js";import{o as u}from"./p-90458c1b.js";import{R as c}from"./p-9e9cb538.js";import{L as p}from"./p-ea00c415.js";import{D as b}from"./p-515e1a3a.js";import{c as m}from"./p-e0194d22.js";import"./p-15b13381.js";class f{constructor(t,i,s,e,n){this.minValue=t,this.maxValue=i,this.disabled=s,this.formatter=e,this.maxCharacters=n,this.inputElement=null,this.lastValue="",this.valueBeforeFocus=""}focus(){var t,i;this.lastValue=null===(t=this.inputElement)||void 0===t?void 0:t.value,this.valueBeforeFocus=this.lastValue,null===(i=this.inputElement)||void 0===i||i.focus()}setValue(t){this.disabled&&(t=h.withMultipleLeadingZeros(this.minValue,4)),this.internalSetValue(null==t||isNaN(+t)?"":t.toString()),this.format()}setInputElementValue(t){null!=this.inputElement&&(this.inputElement.value=t)}internalSetValue(t){this.setInputElementValue(t),this.lastValue=t}sendInput(t){var i;this.setInputElementValue(t);const s=new Event("input",{bubbles:!0,cancelable:!0});s.data=t,s.insertType="insertText",null===(i=this.inputElement)||void 0===i||i.dispatchEvent(s)}preventInput(t,i){if(/delete|history/.test(i))return!1;if("."===t)return this.lastValue!==this.valueBeforeFocus&&this.finish(),!0;const s=Number(t);return!!isNaN(s)||void 0}onInput(t){t.preventDefault();const i=this.inputElement.value;if(this.preventInput(t.data,t.inputType))return this.lastValue===this.valueBeforeFocus&&requestAnimationFrame((()=>{this.inputElement.select()})),void this.internalSetValue(this.lastValue);const s=i.substr(0,this.maxCharacters);this.internalSetValue(s),s.length===this.maxCharacters&&this.finish()}get formattedValue(){var t,i;return null!==(i=this.formatter(null===(t=this.inputElement)||void 0===t?void 0:t.value))&&void 0!==i?i:""}getDisabled(){return this.disabled}setDisabled(t){this.disabled=!!t}finish(){var t;null===(t=this.onFinished)||void 0===t||t.call(this),this.format()}format(){var t,i,s,e,n;const h=parseInt(null===(t=this.inputElement)||void 0===t?void 0:t.value);if(isNaN(h))return void this.internalSetValue("");const r=m(h,this.minValue,this.maxValue);this.internalSetValue(r===h?null===(i=this.formatter)||void 0===i?void 0:i.call(this,null===(s=this.inputElement)||void 0===s?void 0:s.value):null!==(n=null===(e=this.formatter)||void 0===e?void 0:e.call(this,r.toString()))&&void 0!==n?n:"")}isEmpty(){var t,i,s;return this.disabled||0===(null!==(s=null===(i=null===(t=this.inputElement)||void 0===t?void 0:t.value)||void 0===i?void 0:i.length)&&void 0!==s?s:0)}clearInput(){this.disabled||null==this.inputElement||this.internalSetValue(null)}onFocus(){this.inputElement.value.length>0&&(this.focus(),this.inputElement.select())}onBlur(){this.valueBeforeFocus=this.lastValue,this.format()}setInputElement(t){this.inputElement!==t&&(this.inputElement=t,u((()=>{this.format()})))}incrementValue(){const t=""===this.inputElement.value?this.minValue:parseInt(this.inputElement.value)+1;this.setValue(t%(this.maxValue+1)),requestAnimationFrame((()=>{this.inputElement.select()}))}decrementValue(){const t=""===this.inputElement.value?this.maxValue:parseInt(this.inputElement.value)-1;this.setValue(t-this.minValue<0?this.maxValue+(t-this.minValue)+1:t%(this.maxValue+1)),requestAnimationFrame((()=>{this.inputElement.select()}))}}const v=class{constructor(s){t(this,s),this.valueChange=i(this,"valueChange",7),this.valueComplete=i(this,"valueComplete",7),this.errorFound=i(this,"errorFound",7),this.segmentBlur=i(this,"segmentBlur",7),this.preventReFocus=!1,this.dayEmpty=!0,this.monthEmpty=!0,this.yearEmpty=!0,this.currentlyEditing=!1,this.inputFocused=!1,this.internalValue=null,this.value=null,this.disabled=!1,this.readonly=!1,this.required=!1,this.kisynced=!1,this.size="m",this.mode="day-month-year",this.calendarenabled=!0,this.dayInputController=null,this.monthInputController=null,this.yearInputController=null,this.currentFocusedIndex=null}valueChanged(){this.obtainValueChangesFromOutside()}readonlyChanged(){u((()=>{this.updateInputSegments(),this.checkInputs()}))}onModeChange(){this.updateInputControllerDisableStates()}async focusControl(){this.getInputController(g.DAY).focus()}async internalForceEmitChangeEvent(){this.valueChange.emit(this.value),this.valueComplete.emit(this.value),this.lastEmittedChangeValue=this.value,this.lastEmittedCompleteValue=this.value}connectedCallback(){this.initalizeInputController()}componentWillLoad(){const t=()=>{this.focusNext()};this.dayInputController.onFinished=t,this.monthInputController.onFinished=this.isYearEnabled?t:null,this.yearInputController.onFinished=null,this.checkInputs()}componentDidLoad(){this.updateInputSegments(),this.updateCalendarValue(),requestAnimationFrame((()=>{this.checkInputs()}))}initalizeInputController(){this.yearInputController=new f(0,9999,!this.isYearEnabled(),r,4),this.monthInputController=new f(1,12,!this.isMonthEnabled(),x,2),this.dayInputController=new f(1,31,!this.isDateEnabled(),x,2)}updateInputControllerDisableStates(){this.dayInputController.setDisabled(!this.isDateEnabled()),this.monthInputController.setDisabled(!this.isMonthEnabled()),this.yearInputController.setDisabled(!this.isYearEnabled())}checkInputs(){this.dayEmpty=!this.isDateEnabled()||this.dayInputController.isEmpty(),this.monthEmpty=!this.isMonthEnabled()||this.monthInputController.isEmpty(),this.yearEmpty=!this.isYearEnabled()||this.yearInputController.isEmpty(),this.checkValueValidity()}isDateEnabled(){return"month-year"!==this.mode}isMonthEnabled(){return!0}isYearEnabled(){return"day-month"!==this.mode}updateInputSegments(){this.dayInputController.setValue(this.day),this.monthInputController.setValue(this.month),this.yearInputController.setValue(this.year)}focusNext(){var t;const i=((null!==(t=this.currentFocusedIndex)&&void 0!==t?t:-1)+1)%3;this.focus(i)}focusPrevious(){var t;const i=((null!==(t=this.currentFocusedIndex)&&void 0!==t?t:0)+3-1)%3;this.focus(this.isDateEnabled()||0!==i?i:2)}focus(t){var i;null===(i=this.getInputController(t))||void 0===i||i.focus()}obtainValueChangesFromOutside(){var t;const i=null!==(t=this.formatToDateString(this.value))&&void 0!==t?t:"";this.value!==this.internalValue&&(this.internalValue=i,this.lastEmittedChangeValue=this.value,this.lastEmittedCompleteValue=this.value,this.updateInputSegments(),this.checkInputs()),this.checkValueValidity()}checkValueValidity(){let t=b.NO_ERROR;null==this.value?this.isInputValid()&&(t=b.INVALID_DATE):this.min&&h.isBeforeDate(new Date(this.value),new Date(this.min))?t=b.UNDER_MIN:this.max&&h.isAfterDate(new Date(this.value),new Date(this.max))&&(t=b.OVER_MAX);const i=this.getErrorMessage(t);t===this.lastErrorType&&i===this.internalErrorMessage||(this.internalErrorMessage=i,this.errorFound.emit({type:t,message:this.internalErrorMessage}),this.lastErrorType=t)}getErrorMessage(t){return{[b.INVALID_DATE]:()=>`Das eingegebene Datum ${this.dayInputController.formattedValue}.${this.monthInputController.formattedValue}.${this.yearInputController.formattedValue} ist nicht valide.`,[b.UNDER_MIN]:()=>`Das eingegebene Datum muss nach dem ${this.getFormattedDisplayDate(this.min)} liegen.`,[b.OVER_MAX]:()=>`Das eingegebene Datum muss vor dem ${this.getFormattedDisplayDate(this.max)} liegen.`,[b.NO_ERROR]:()=>""}[t]()}getFormattedDisplayDate(t){const i=h.getFormattedDisplayDate(t);if("day-month-year"===this.mode)return i;const s=i.split(".");return"day-month"===this.mode?`${s[0]}.${s[1]}`:"month-year"===this.mode?`${s[1]}.${s[2]}`:void 0}emitValueChange(){this.lastEmittedChangeValue!==this.internalValue&&(this.value=this.internalValue,this.valueChange.emit(this.value),this.lastEmittedChangeValue=this.value,this.checkInputs())}emitValueComplete(){this.lastEmittedCompleteValue!==this.value&&(this.updateCalendarValue(),this.valueComplete.emit(this.value),this.lastEmittedCompleteValue=this.value,this.checkInputs())}updateCalendarValue(){null!=this.calendar&&(this.calendar.value=this.value)}isInputValid(){return parseFloat(this.dayInputController.formattedValue)*parseFloat(this.monthInputController.formattedValue)*parseFloat(this.yearInputController.formattedValue)>0}formatToDateString(t){if(null==t)return null;const i=new Date(t);if(isNaN(i.getTime()))return null;{const s=t.split("-").map((t=>parseFloat(t)));return s[2]!==i.getDate()||s[1]!==i.getMonth()+1||s[0]!==i.getFullYear()?null:h.dateToString(i)}}onFocusInput(){this.inputFocused=!0}handleKeyInput(t){if("Enter"===t.code)t.target.blur();else if(!t.code.startsWith("Arrow")){if("Tab"!==t.code&&!t.code.startsWith("Shift")&&!this.currentlyEditing){this.currentlyEditing=!0,this.currentFocusedIndex=0;const i=this.getInputController(this.currentFocusedIndex);i.focus(),i.sendInput(t.key),t.preventDefault()}return}t.code.includes("Arrow")&&(t.preventDefault(),"ArrowLeft"===t.code?this.focusPrevious():"ArrowRight"===t.code?this.focusNext():"ArrowUp"===t.code?this.incrementCurrentSegment():"ArrowDown"===t.code&&this.decrementCurrentSegment())}incrementCurrentSegment(){var t;null===(t=this.getInputController(this.currentFocusedIndex))||void 0===t||t.incrementValue(),this.updateInternalValue()}decrementCurrentSegment(){var t;null===(t=this.getInputController(this.currentFocusedIndex))||void 0===t||t.decrementValue(),this.updateInternalValue()}getInputController(t){switch(t){case g.DAY:return this.isDateEnabled()?this.dayInputController:this.monthInputController;case g.MONTH:return this.monthInputController;case g.YEAR:return this.yearInputController}}clearInput(){this.dayInputController.clearInput(),this.monthInputController.clearInput(),this.yearInputController.clearInput(),this.dayEmpty=!0,this.monthEmpty=!0,this.yearEmpty=!0,this.updateInternalValue()}onBlur(){this.updateInternalValue(),this.updateCalendarValue(),this.segmentBlur.emit(),u((()=>{!this.preventReFocus&&d(this.self)||(this.currentlyEditing=!1,this.currentFocusedIndex=null,this.inputFocused=!1,this.emitValueComplete()),this.preventReFocus=!1}))}setFocusedIndex(t){this.currentFocusedIndex=t,this.currentlyEditing=!0}get day(){if(null==this.value)return null;const t=new Date(this.value).getDate();return h.withMultipleLeadingZeros(t,2)}get month(){if(null==this.value)return null;const t=new Date(this.value).getMonth()+1;return h.withMultipleLeadingZeros(t,2)}get year(){if(null==this.value)return null;const t=new Date(this.value).getFullYear();return h.withMultipleLeadingZeros(t,4)}handleInput(t,i){i.onInput(t),this.updateInternalValue()}updateInternalValue(){const t=this.dayInputController.getDisabled()?"01":this.dayInputController.formattedValue,i=this.monthInputController.getDisabled()?"01":this.monthInputController.formattedValue,s=this.yearInputController.getDisabled()?"0000":this.yearInputController.formattedValue,e=""!==t&&""!==i&&""!==s?this.formatToDateString(`${s}-${i}-${t}`):null;e!==this.value&&(this.internalValue=e,this.emitValueChange()),this.checkInputs()}selectDate(t){var i;this.internalValue=h.dateToString(t),this.emitValueChange();const s=null===(i=this.value)||void 0===i?void 0:i.split("-");null!=s?(this.dayInputController.setValue(null==s?void 0:s[2]),this.monthInputController.setValue(null==s?void 0:s[1]),this.yearInputController.setValue(null==s?void 0:s[0])):this.clearInput(),this.checkInputs(),this.dayInputController.focus()}setCalendar(t){this.calendar!==t&&(this.calendar=t,this.updateCalendarValue())}renderHiddenFallbackInput(t){return s("input",{hidden:!0,tabIndex:-1,ref:i=>{t.setInputElement(i)},type:"text",disabled:!0})}renderDayInput(){return this.isDateEnabled()?[s("input",{id:o.createId(this.self,"day-control"),tabIndex:this.currentlyEditing?0:-1,ref:t=>{this.dayInputController.setInputElement(t)},type:"text",class:{day:!0},onFocus:()=>{this.setFocusedIndex(g.DAY),this.dayInputController.onFocus(),this.onFocusInput()},onBlur:()=>{this.dayInputController.onBlur(),this.onBlur()},placeholder:"TT",maxLength:2,onChange:()=>this.updateInternalValue(),onInput:t=>this.handleInput(t,this.dayInputController),disabled:this.disabled}),s("dx-text",{class:{dot:!0,disabled:this.dayInputController.isEmpty()}},".")]:this.renderHiddenFallbackInput(this.dayInputController)}renderMonthInput(){return this.isMonthEnabled()?[s("input",{id:o.createId(this.self,"month-control"),tabIndex:this.currentlyEditing?0:-1,ref:t=>{this.monthInputController.setInputElement(t)},type:"text",class:{month:!0,empty:this.monthEmpty},onFocus:()=>{this.setFocusedIndex(1),this.monthInputController.onFocus(),this.onFocusInput()},onBlur:()=>{this.monthInputController.onBlur(),this.onBlur()},placeholder:"MM",maxLength:2,onChange:()=>this.updateInternalValue(),onInput:t=>this.handleInput(t,this.monthInputController),disabled:this.disabled}),s("dx-text",{class:{dot:!0,disabled:this.monthInputController.isEmpty()}},".")]:this.renderHiddenFallbackInput(this.monthInputController)}renderYearInput(){return this.isYearEnabled()?s("input",{id:o.createId(this.self,"year-control"),tabIndex:this.currentlyEditing?0:-1,class:{year:!0,empty:this.yearEmpty},ref:t=>{this.yearInputController.setInputElement(t)},type:"text",onFocus:()=>{this.setFocusedIndex(2),this.yearInputController.onFocus(),this.onFocusInput()},onBlur:()=>{this.onBlur(),this.yearInputController.onBlur()},placeholder:"JJJJ",maxLength:4,onChange:()=>this.updateInternalValue(),onInput:t=>this.handleInput(t,this.yearInputController),disabled:this.disabled}):this.renderHiddenFallbackInput(this.yearInputController)}renderInput(){var t;const i=(null===(t=this.internalErrorMessage)||void 0===t?void 0:t.length)>0||a(this.self);return s("label",{id:o.createId(this.self,"control")},s(p,{containerProperties:{active:this.inputFocused,size:this.size,error:i,custom:{tabIndex:this.currentlyEditing||this.disabled?-1:0,onFocus:()=>this.onFocusInput(),onBlur:()=>this.onBlur(),onInput:()=>this.checkInputs(),onKeyDown:t=>this.handleKeyInput(t)},title:this.getFormattedDisplayDate(this.value)},labelProperties:{label:this.label,disabled:this.disabled,required:this.required,kisynced:this.kisynced}},s("dx-flyout",{open:this.inputFocused,offsety:4,hideoverlay:!this.calendarenabled},s("div",{class:{"inner-container":!0,"size-s":"s"===this.size,"size-m":"m"===this.size,active:this.inputFocused,error:i}},s("div",{class:"input-container"},this.renderDayInput(),this.renderMonthInput(),this.renderYearInput()),this.renderIconOrClearButton()),this.renderCalendar())))}renderClearButton(){return s("dx-clear-button",{onClearInput:()=>this.clearInput(),id:o.createId(this.self,"clear-button")})}renderIconOrClearButton(){return s("div",{class:"right-side"},!this.inputFocused||this.dayEmpty&&this.monthEmpty&&this.yearEmpty?s("dx-icon",{icon:"kalender",size:24}):this.renderClearButton())}renderCalendar(){var t,i;if(this.calendarenabled)return s("dx-calendar",{slot:"overlay",id:o.createId(this.self,"calendar"),ref:t=>this.setCalendar(t),mode:this.mode,tabindex:-1,min:null!==(t=this.min)&&void 0!==t?t:"",max:null!==(i=this.max)&&void 0!==i?i:"",errormessage:this.internalErrorMessage,onBlur:()=>{this.onBlur(),this.dayInputController.onBlur()},onRangeSelected:t=>{this.selectDate(t.detail.from)}})}render(){var t;if(this.readonly){const i=new Date(this.value);return s(c,{text:(null===(t=this.value)||void 0===t?void 0:t.length)>0?this.getFormattedDisplayDate(i):"n.a.",label:this.label})}return s(e,{class:{disabled:this.disabled}},this.renderInput(),s(l,{self:this.self,message:this.errormessage,custom:{onFocus:()=>{this.preventReFocus=!0},onBlur:()=>{this.preventReFocus=!1}}}))}get self(){return n(this)}static get watchers(){return{value:["valueChanged"],readonly:["readonlyChanged"],mode:["onModeChange"]}}};function x(t){return t?h.withLeadingZero(parseInt(t)):t}var g;!function(t){t[t.DAY=0]="DAY",t[t.MONTH=1]="MONTH",t[t.YEAR=2]="YEAR"}(g||(g={})),v.style=":host{min-width:0;display:block}:host:host([hidden]){display:none !important}:host:host(.disabled){pointer-events:none}:host:host(.disabled:not(.nested-form-element)){opacity:0.4}:host label .container{outline:none}:host label .container .inner-container{outline:none;justify-content:space-between;padding-right:16px}:host label .container .inner-container.size-s{position:relative;top:0;left:0;display:flex;height:40px;padding:8px 16px 8px 16px;--dx-info-button-offset-y:0px;box-sizing:border-box;border:1px solid #d6d6d6;border-bottom:var(--dx-container-border-bottom, 1px solid #d6d6d6);background-color:#ffffff;align-items:center;--dx-icon-color:#337a96}:host label .container .inner-container.size-s.error{border-color:#9d2235;background-color:#f5e9eb}:host label .container .inner-container.size-s.error input,:host label .container .inner-container.size-s.error textarea{background:transparent}:host label .container .inner-container.size-s.active{border-color:#004763;--dx-text-color:#004763;--dx-icon-color:#004763}:host label .container .inner-container.size-m{position:relative;top:0;left:0;display:flex;height:48px;padding:10px 16px 10px 16px;box-sizing:border-box;border:1px solid #d6d6d6;border-bottom:var(--dx-container-border-bottom, 1px solid #d6d6d6);background-color:#ffffff;align-items:center;--dx-icon-color:#337a96}:host label .container .inner-container.size-m.error{border-color:#9d2235;background-color:#f5e9eb}:host label .container .inner-container.size-m.error input,:host label .container .inner-container.size-m.error textarea{background:transparent}:host label .container .inner-container.size-m.active{border-color:#004763;--dx-text-color:#004763;--dx-icon-color:#004763}:host label .container .inner-container .input-container input{height:24px;border:none;outline:none;font-family:DVAG-Type;font-size:16px;line-height:24px;letter-spacing:0.02px;color:#2b2b2b;width:1px;flex-grow:1;padding:0;flex:none;text-align:right;margin:0}@media (min-width: 1280px){:host label .container .inner-container .input-container input{font-size:18px;line-height:28px}}:host label .container .inner-container .input-container input::placeholder{color:#ababab;opacity:1}:host label .container .inner-container .input-container input:disabled{background-color:#ffffff}:host label .container .inner-container .input-container input.day{width:2.1ch}:host label .container .inner-container .input-container input.month{width:2ch}:host label .container .inner-container .input-container input.month.empty{width:3.2ch}:host label .container .inner-container .input-container input.year{width:4ch}:host label .container .inner-container .input-container input.year.empty{width:3.6ch}:host label .container .dot.disabled{--dx-text-color:#ababab}:host label .container .right-side{display:flex;justify-content:center;align-items:center;width:28px;height:28px}";export{v as dx_date_input}
import{r as t,c as i,h as e,F as s,H as o,g as n}from"./p-c66bef8d.js";import{v as l,E as r}from"./p-70f48e14.js";import{o as h}from"./p-90458c1b.js";import{a}from"./p-aa0a06c6.js";import{e as d}from"./p-333a100c.js";import{B as c,R as u}from"./p-9e9cb538.js";import{h as p,E as b}from"./p-747d527e.js";import{L as x}from"./p-ea00c415.js";import"./p-15b13381.js";const f=class{constructor(e){t(this,e),this.valueChange=i(this,"valueChange",7),this.valueComplete=i(this,"valueComplete",7),this.search=i(this,"search",7),this.selectSearchOption=i(this,"selectSearchOption",7),this.enterPress=i(this,"enterPress",7),this.preventReFocus=!1,this.lastSelectedOption=null,this.inputFocused=!1,this.internalValue="",this.listOpen=!1,this.waitForMoreInput=!1,this.isLoading=!1,this.maxlistheight=void 0,this.loadingtext="Suchergebnisse werden geladen",this.emptysearchtext="Keine Suchergebnisse zu Ihrer Eingabe gefunden.",this.size="m",this.value="",this.placeholder="Bitte eingeben ...",this.disabled=!1,this.readonly=!1,this.kisynced=!1,this.presearchlettercount=0}onSelectedOptionChanged(t,i){this.internalIcon=(null==t?void 0:t.icon)||(null==i?void 0:i.icon)||this.internalIcon}onIsLoadingChanged(){var t;if(!this.inputFocused&&!this.isLoading&&(null===(t=this.internalValue)||void 0===t?void 0:t.length)>0){const t=this.findOption(this.internalValue);t?t!==this.selectedOption&&(this.selectedOption=t,this.selectedOption?this.selectOption(this.selectedOption):this.inputFocused||(this.internalErrorMessage=this.emptysearchtext)):this.internalErrorMessage=this.emptysearchtext}}valueChanged(){this.obtainValueChangesFromOutside()}onItemSelectionChanged(t){var i,e;this.selectedOption=this.findOption(null===(e=null===(i=t.detail)||void 0===i?void 0:i.selectedItems)||void 0===e?void 0:e[0]),"implicit"===t.detail.reason?h((()=>{this.focusControl()})):(this.preventReFocus=!0,a(this.inputElement)?this.inputElement.blur():this.onBlurred(),this.selectOption(this.selectedOption))}async focusControl(){this.inputElement.focus()}componentWillLoad(){l(this.self),this.obtainValueChangesFromOutside(!0)}onForceUpdateOnChange(t){t.detail(this.self)}obtainValueChangesFromOutside(t=!1){if(t||this.value!==this.internalValue){if(null==this.value&&null==this.internalValue)return;this.internalValue=this.value,this.lastEmittedChangeValue=this.value,this.lastEmittedCompleteValue=this.value,this.inputFocused&&this.startSearch(void 0)}}findOption(t){var i,e,s;return null===(s=null===(e=null===(i=this.searchResult)||void 0===i?void 0:i.map((t=>{var i;return null!==(i=t.options)&&void 0!==i?i:[]})))||void 0===e?void 0:e.flat())||void 0===s?void 0:s.find((i=>{return(null==(e=v(i))?void 0:e.length)===(null==(s=t)?void 0:s.length)&&(null==e?void 0:e.toLowerCase())===(null==s?void 0:s.toLowerCase());var e,s}))}onFocused(){this.inputFocused||(this.listOpen=!0,this.startSearch("focus")),this.inputFocused=!0,h((()=>{this.focusControl()}))}onDocumentBlur(){this.preventReFocus=!0,this.inputElement.blur()}onBlurred(){h((()=>{if(this.preventReFocus||!a(this.self)){if(this.isLoading){if(null!=this.selectedOption){const t=this.findOption(this.internalValue);this.isLoading=t!==this.selectedOption}}else{const t=this.findOption(this.internalValue);t?(this.selectedOption=t,this.selectOption(t)):this.internalValue!==v(this.selectedOption)&&(this.selectedOption=this.internalValue?this.lastSelectedOption:null,this.internalSelectOption(this.selectedOption))}this.listOpen=!1,this.inputFocused=!1}this.preventReFocus=!1}))}onListFlyoutClicked(t){d(t).some((t=>{var i;return"dx-list-item"===(null===(i=t.tagName)||void 0===i?void 0:i.toLowerCase())}))&&this.emitValueComplete()}internalClearInput(){this.inputElement.value="",this.internalValue="",this.selectedOption=null,this.lastSelectedOption=null,this.internalErrorMessage="",this.emitValueChange()}clearInput(){this.internalClearInput(),this.inputFocused&&(this.startSearch("clear"),h((()=>{this.focusControl()})))}onInputKeyDown(t){var i,e;if("Enter"==t.key)if(this.enterPress.emit(),this.isLoading){if(this.isLoading)return void this.inputElement.blur()}else{if(0===(null!==(e=null===(i=this.searchResult)||void 0===i?void 0:i.length)&&void 0!==e?e:0))return this.internalErrorMessage=this.emptysearchtext,this.lastSelectedOption=null,this.selectedOption=null,void this.inputElement.blur();if(!this.listOpen){const t=this.findOption(this.internalValue);if(t)return this.selectOption(t),void this.inputElement.blur()}}this.listOpen&&["ArrowDown","ArrowUp"].includes(t.key)&&t.preventDefault();const s=this.self.shadowRoot.querySelector("dx-list-flyout");t.target!==s&&(null==s?void 0:s.open)&&(null==s||s.dispatchEvent(new t.constructor(t.type,t)))}onInputInput(){this.internalValue=this.inputElement.value,this.listOpen=!0,this.startSearch("input"),this.emitValueChange()}internalSelectOption(t){var i;this.lastSelectedOption=t;const e=v(t);null!=e?(this.internalErrorMessage="",this.internalValue=e):this.internalErrorMessage=(null===(i=this.internalValue)||void 0===i?void 0:i.length)>0?this.emptysearchtext:"",this.emitValueChange(),this.emitValueComplete()}selectOption(t){var i;this.internalSelectOption(t),this.selectSearchOption.emit(null!==(i=t.data)&&void 0!==i?i:v(t))}startSearch(t){var i;if(this.waitForMoreInput=(null===(i=this.internalValue)||void 0===i?void 0:i.length)<this.presearchlettercount,this.waitForMoreInput)return void(this.isLoading=!1);let e=!1;requestAnimationFrame((()=>{this.isLoading=!e})),this.search.emit({value:this.internalValue,reason:t,provideValues:t=>{e=!0,this.searchResult=t,this.isLoading=!1}})}emitValueChange(){const t=this.internalValue;this.lastEmittedChangeValue!==t&&(this.value=t,this.valueChange.emit(this.value),this.lastEmittedChangeValue=this.value,this.value||(this.selectedOption=null))}emitValueComplete(){this.lastEmittedCompleteValue!==this.value&&(this.valueComplete.emit(this.value),this.lastEmittedCompleteValue=this.value)}renderInputIcon(){var t,i;return e("dx-horizontal-grow-box",{open:!this.inputFocused&&(null===(i=null===(t=this.selectedOption)||void 0===t?void 0:t.icon)||void 0===i?void 0:i.length)>0,forcewidth:40,animationmode:"open-from-left"},e("dx-icon",{class:"input-icon",size:24,icon:this.internalIcon,color:"headline"}))}renderInput(){var t;return e("label",{class:{"container-size-s":"s"===this.size,"container-size-m":"m"===this.size}},e(x,{containerProperties:{active:this.inputFocused,size:this.size,title:this.value,error:p(this.self)||(null===(t=this.internalErrorMessage)||void 0===t?void 0:t.length)>0},labelProperties:{disabled:this.disabled,label:this.label,required:this.required,kisynced:this.kisynced}},e(c,null),this.renderInputIcon(),e("input",{enterKeyHint:"next",id:r.createId(this.self,"control"),ref:t=>this.inputElement=t,onInput:()=>this.onInputInput(),onKeyDown:t=>this.onInputKeyDown(t),onFocus:()=>this.onFocused(),onBlur:()=>this.onBlurred(),type:"text",placeholder:this.placeholder,value:this.internalValue,maxLength:this.limitlength,disabled:this.disabled}),this.renderIconAndClearButton()),this.renderAutocompleteValues())}renderDefaultContainer(t){return e("div",{class:"default-list-container",key:"default-container"},t)}renderListContent(){var t;return this.waitForMoreInput?this.renderDefaultContainer(e("dx-text",null,this.presearchconditiontext||`Bitte geben Sie einen Suchbegriff ein (min. ${this.presearchlettercount} Zeichen).`)):this.isLoading?this.renderDefaultContainer(e("div",{class:"loading-container"},e("dx-spinner",{class:"loading-spinner",size:"medium",theme:"light"}),e("dx-text",{color:"headline"},this.loadingtext))):(null===(t=this.searchResult)||void 0===t?void 0:t.length)>0?this.searchResult.map((t=>this.renderCategory(t))):this.renderDefaultContainer(e("dx-text",{color:"headline"},this.emptysearchtext))}renderCategory(t){var i;return[t.label?e("div",{class:"category"},e("dx-text",{type:"it"},t.label)):null].concat(null===(i=t.options)||void 0===i?void 0:i.map((t=>{const i=v(t);return e("dx-list-item",{id:r.createId(this.self,i.toLowerCase().replace(" ","-")),value:i,prelabel:t.preLabel,label:t.label,sublabel:t.subLabel,icon:t.icon,type:"selectable",selected:v(this.selectedOption)===i})})))}renderAutocompleteValues(){var t;return e("dx-list-flyout",{maxheight:this.maxlistheight,defaulthighlightfirst:!0,preventSpaceSelection:!0,selectonhighlight:!1,preventArrowSelection:!0,focusable:!1,open:this.listOpen,position:"bottom",direction:"right",itemsvisible:5.5,size:"m",selectionmode:"single",onClick:t=>this.onListFlyoutClicked(t),class:{"respect-label-height":(null===(t=this.label)||void 0===t?void 0:t.length)>0}},e("div",{slot:"base"}),this.renderListContent())}renderOpenListButton(){return e("button",{tabIndex:-1,id:r.createId(this.self,"open-list-button"),class:{"open-list-button":!0},onClick:()=>{this.inputFocused&&(this.listOpen=!this.listOpen),this.focusControl()}},e("dx-chevron",{directiontop:this.listOpen,active:this.inputFocused}))}renderIconAndClearButton(){var t;const i=(null===(t=this.internalValue)||void 0===t?void 0:t.length)>0;return e(s,null,e("dx-element-swapper",{active:i?"second":"first"},e("dx-icon",{slot:"first",size:24,icon:"lupe",color:"default",class:"display-icon"}),e("dx-element-swapper",{slot:"second",active:this.isLoading&&!this.inputFocused?"first":"second"},e("dx-spinner",{slot:"first",size:"medium",theme:"light"}),e("dx-clear-button",{tabIndex:-1,slot:"second",visible:!0,size:24,onClearInput:()=>this.clearInput(),id:r.createId(this.self,"clear-button")}))),e("dx-spacer",{mq1:"8h"}),e("div",{class:"separator"}),e("dx-spacer",{mq1:"8h"}),this.renderOpenListButton())}render(){return this.readonly?e(u,{text:this.value,label:this.label}):e(o,{class:{disabled:this.disabled},onBlur:()=>this.onBlurred()},this.renderInput(),e(b,{self:this.self,message:this.errormessage||this.internalErrorMessage,custom:{onFocus:()=>{this.preventReFocus=!0},onBlur:()=>{this.preventReFocus=!1}}}))}get self(){return n(this)}static get watchers(){return{selectedOption:["onSelectedOptionChanged"],isLoading:["onIsLoadingChanged"],value:["valueChanged"]}}};function v(t){return(null==t?void 0:t.value)||(null==t?void 0:t.label)}f.style=":host{min-width:0;display:block}:host:host([hidden]){display:none !important}:host:host(.disabled){pointer-events:none}:host:host(.disabled:not(.nested-form-element)){opacity:0.4}:host label{display:block}:host label.container-size-s{--dx-overlay-offset:40px}:host label.container-size-m{--dx-overlay-offset:48px}:host label .container.size-s{position:relative;top:0;left:0;display:flex;height:40px;padding:8px 16px 8px 16px;--dx-info-button-offset-y:0px;box-sizing:border-box;border:1px solid #d6d6d6;border-bottom:var(--dx-container-border-bottom, 1px solid #d6d6d6);background-color:#ffffff;align-items:center;--dx-icon-color:#337a96}:host label .container.size-s.error{border-color:#9d2235;background-color:#f5e9eb}:host label .container.size-s.error input,:host label .container.size-s.error textarea{background:transparent}:host label .container.size-s.active{border-color:#004763;--dx-text-color:#004763;--dx-icon-color:#004763}:host label .container.size-m{position:relative;top:0;left:0;display:flex;height:48px;padding:10px 16px 10px 16px;box-sizing:border-box;border:1px solid #d6d6d6;border-bottom:var(--dx-container-border-bottom, 1px solid #d6d6d6);background-color:#ffffff;align-items:center;--dx-icon-color:#337a96}:host label .container.size-m.error{border-color:#9d2235;background-color:#f5e9eb}:host label .container.size-m.error input,:host label .container.size-m.error textarea{background:transparent}:host label .container.size-m.active{border-color:#004763;--dx-text-color:#004763;--dx-icon-color:#004763}:host label .container input{height:24px;border:none;outline:none;font-family:DVAG-Type;font-size:16px;line-height:24px;letter-spacing:0.02px;color:#2b2b2b;width:1px;flex-grow:1;padding:0}@media (min-width: 1280px){:host label .container input{font-size:18px;line-height:28px}}:host label .container input::placeholder{color:#ababab;opacity:1}:host label .container input:disabled{background-color:#ffffff}:host label .container .input-icon{margin-right:16px}:host label .respect-label-height{--dx-overlay-offset:-24}@media (min-width: 1280px){:host label .respect-label-height{--dx-overlay-offset:-28}}:host label .default-list-container{min-height:64px;padding:20px 16px;box-sizing:border-box}@media (min-width: 1280px){:host label .default-list-container{min-height:68px}}:host label .default-list-container .loading-container{display:flex;align-items:center}:host label .default-list-container .loading-container .loading-spinner{flex-shrink:0;flex-grow:0;margin-right:16px}:host label .category{padding:8px 16px;background-color:#f7f7f7;border-bottom:1px solid #d6d6d6}:host .separator{flex:0 0 1px;height:24px;background-color:#d6d6d6}:host .open-list-button{width:var(--dx-button-width, fit-content);width:var(--dx-button-width, -moz-fit-content);cursor:pointer;display:inline-flex;justify-content:center;align-items:center;box-sizing:border-box;white-space:nowrap;user-select:none;-webkit-user-select:none;border:none;margin:0;background-color:transparent;transition:background-color 150ms ease-in-out, border-color 150ms ease-in-out;outline-offset:2px;padding:0}:host .open-list-button[disabled]{cursor:unset}:host .open-list-button.icon-right{flex-direction:row-reverse}:host .open-list-button:focus-visible{outline:2px solid #004763}";export{f as dx_combobox}